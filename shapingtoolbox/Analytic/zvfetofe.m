function [shap]=ZVFETOFE(w,alpha,xd)%shap=ZVFETOFE(w,alpha,xd)%Generate a shaper for rest-to-rest slewing%The first 3 impulses acheive FE acceleration with no residual vibration%The middle 3 impulses switch the deflection from compression to extension in a TO manner% so that the system may be slowed down.  The transition is made without residual%The last 3 impulses bring the system to rest and are a mirror of the first 3.% w = frequency in radians% alpha = force-to-mass ratio (Umax/M)% xd = desired slew distancetau=2*pi/w;          %system period%Calculate impulse timest1=0;t2=tau/6;t3=tau/3;t5=tau/6+sqrt(xd/alpha);t4=t5-pi/(3*w);t6=2*t5-t4;t7=2*t5-t3;t8=2*t5-t2;t9=2*t5;t=[t1 t2 t3 t4 t5 t6 t7 t8 t9];amps=[1 -1  1 -2 2 -2  1 -1 1];%min slew distance is tau^2*alpha/9if xd<(tau^2*alpha/9)   	fprintf('slew distance too short\n')end                   shap=[t' amps'];shap = seqsort(shap);     %sort the shaper because t6 could be less than t5