function [shap]=ZVFE2FEFE(w,alpha,xd)%shap=ZVFETOFE(w,alpha,xd)%Generate a shaper for rest-to-rest slewing%The first three impulses acheive FE acceleration with no residual vibration%The middle 5 impulses are actually 2 sets of ZV FE impulses that% switch the deflection from compression to extension% so that the system may be slowed down.  The transition is made without residual% by making the two -1 impulses one half cycle apart%The last three impulses bring the system to rest and are a mirror of the first 3.% w = frequency in radians% alpha = force-to-mass ratio (Umax/M)% xd = desired slew distancetau=2*pi/w;          %system period%Calculate impulse timest1=0;t2=pi/(3*w);t3=2*t2;t6=tau/6+0.5*sqrt((tau/3)^2+4*xd/alpha);t4=t6-t3;t5=t6-t2;t7=t6+t2;t8=t6+t3;t9=2*t6-t3;t10=2*t6-t2;t11=2*t6;t=[t1 t2 t3 t4 t5 t6 t7 t8 t9 t10 t11];amps=[1 -1  1 -1  1 -2 1 -1 1 -1 1];%min slew distance is 2*alpha*tau^2/9if xd<(2*alpha*tau^2/9)   	fprintf('slew distance too short\n')end                   shap=[t' amps'];shap = seqsort(shap);     %sort the shaper because t6 could be less than t5