function [shap]=ZVDTOTOTO(w,alpha,xd)%shap=ZVDTOTOTO(w,alpha,xd)%Generate a shaper for rest-to-rest slewing%The first 5 impulses acheive TO acceleration with no residual vibration%The middle 5 impulses switch the deflection from compression to extension % in a TO manner% so that the system may be slowed down.  The transition is made without residual%The last 5 impulses bring the system to rest and are a mirror of the first 5.% w = frequency in radians% alpha = force-to-mass ratio (Umax/M)% xd = desired slew distancetau=2*pi/w;          %system period%Calculate impulse timest1=0;t2=0.152406*tau;t3=0.277396*tau;t4=0.631311*tau;t5=0.678948*tau;ta=0.0895126*tau;tb=0.362338*tau;t8=2*(t5-t4+t3-t2)+sqrt(6*t2^2+2*t3^2+6*t4^2+2*t5^2-2*ta^2-...   8*t2*t3+8*t2*t4-8*t2*t5-8*t3*t4+8*t3*t5-8*t4*t5+4*ta*tb+xd/alpha);%t8=6;t6=t8-tbt6=-0.017084*tau+sqrt((0.0252*tau)^2+xd/alpha)t7=t8-tb+tat7=t6+0.0895126*tau t8t8=t6+0.362338*taut9=2*t8-t7;t10=2*t8-t6;t11=2*t8-t5;t12=2*t8-t4;t13=2*t8-t3;t14=2*t8-t2;t15=2*t8;t=[t1 t2 t3 t4 t5 t6 t7 t8 t9 t10 t11 t12 t13 t14 t15];amps=[1 -2 2 -2 2 -2 2 -2 2 -2 2 -2 2 -2 1];%min slew distance is alpha*0.48382548*tau^2if xd<alpha*0.48382548*tau^2	fprintf('slew distance too short\n')end                   shap=[t' amps'];shap = seqsort(shap);     %sort the shaper because t6 could be less than t5